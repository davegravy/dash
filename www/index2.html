<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AEL Monitoring Dashboard</title>

    <!-- Global stylesheets -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700,900" rel="stylesheet" type="text/css">
    <link href="assets/css/icons/icomoon/styles.css" rel="stylesheet" type="text/css">
    <link href="assets/css/bootstrap.css" rel="stylesheet" type="text/css">
    <link href="assets/css/core.css" rel="stylesheet" type="text/css">
    <link href="assets/css/components.css" rel="stylesheet" type="text/css">
    <link href="assets/css/colors.css" rel="stylesheet" type="text/css">
    <!-- /global stylesheets -->

    <!-- Core JS files -->
    <script type="text/javascript" src="assets/js/core/libraries/jquery.min.js"></script>
    <script type="text/javascript" src="assets/js/core/libraries/bootstrap.min.js"></script>
    <script type="text/javascript" src="assets/js/plugins/visualization/d3/d3.min.js"></script>
    <script type="text/javascript" src="assets/js/plugins/auth/deleteable-core.js"></script>
    <!--<script type="text/javascript" src="assets/js/plugins/visualization/d3/d3_tooltip.js"></script>-->
    <!-- /core JS files -->

    <!-- Theme JS files -->
    <script type="text/javascript" src="assets/js/plugins/ui/nicescroll.min.js"></script>
    <script type="text/javascript" src="assets/js/plugins/forms/selects/bootstrap_multiselect.js"></script>
    <script type="text/javascript" src="assets/js/plugins/forms/styling/uniform.min.js"></script>

    <script type="text/javascript">

        function loadScript(url, callback) // function to allow us to load core scripts in jQuery.load callbackforcing them to not run before sidebar is added.
        {
            // Adding the script tag to the head as suggested before
            var head = document.getElementsByTagName('head')[0];
            var script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = url;

            // Then bind the event to the callback function.
            // There are several events for cross browser compatibility.
            script.onreadystatechange = callback;
            script.onload = callback;

            // Fire the loading
            head.appendChild(script);
        }

        function loadMain() {
            $('body').load('main_body.html', function(response, status, xhr){

                $( "#main_navbar" ).load( "main_navbar.html", function( response, status, xhr ) {
                    if ( status == "error" ) {
                        console.log ("error");
                    }
                });
                $( "#main_content" ).load( "main_content.html", function( response, status, xhr ) {
                    if ( status == "error" ) {
                        console.log ("error");
                    }
                });
                $( "#main_sidebar" ).load( "main_sidebar.html", function( response, status, xhr ) {
                    if ( status == "error" ) {
                        console.log ("error");
                    }
                    else {
                        console.log ("finished loading sidebar");
                        loadScript("assets/js/core/limitless-app.js");
                        loadScript("assets/js/pages/layout_fixed_custom.js");
                    }

                });
            });
        }

        $(document).ready(function() {
            //localStorage.removeItem('ARMS_idtoken');
            //console.log($('body').html());

            var idToken;
            //var idToken = localStorage.getItem('ARMS_idtoken');

            if (idToken !== undefined && idToken !== null) {
                verifyToken(idToken,"id");
            }

            (function mainloop() {

                idToken = localStorage.getItem('ARMS_idtoken');
                //console.log (idToken);


                if (null === idToken) {
                    if ($('.login-container').length === 0) {
                        console.log("loading login page");
                        $('body').load('login_advanced.html', function (response, status, xhr) {
                            if (status == "error") {
                                console.log("error");
                            }
                        });

                    }
                }
                else {
                    if ($('.navbar-top').length == 0 ) {
                        console.log("loading main body");
                        loadMain()
                    }
                }
                setTimeout(mainloop, 1000);
            })();

        });





    </script>

    <!--<script type="text/javascript" src="assets/js/core/app.js"></script>
    <script type="text/javascript" src="assets/js/pages/layout_fixed_custom.js"></script>-->
    <!-- /theme JS files -->

</head>
<body id="test">

</body>
</html>